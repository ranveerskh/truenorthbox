<!-- Same HEAD & NAV from before -->
<!-- ... -->

<style>
  /* Add these to your existing styles */
  .preview-popup {
    position: fixed;
    top: 20%;
    left: 50%;
    transform: translateX(-50%);
    width: 90%;
    max-width: 400px;
    background: white;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.25);
    z-index: 999;
    display: none;
    animation: fadeIn 0.3s ease;
  }
  .preview-popup img {
    width: 100%;
    height: 200px;
    object-fit: cover;
    border-radius: 8px;
  }
  .preview-popup h3 {
    margin: 10px 0 5px;
  }
  .preview-popup p {
    font-size: 0.95rem;
    color: #333;
  }
  .preview-popup .btn {
    display: inline-block;
    margin-top: 10px;
    background: #2f855a;
    color: white;
    padding: 8px 14px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    text-decoration: none;
  }
  @keyframes fadeIn {
    from { opacity: 0; transform: translateX(-50%) translateY(10px); }
    to { opacity: 1; transform: translateX(-50%) translateY(0); }
  }
</style>

<!-- Add this just before </body> -->
<div id="quickPreview" class="preview-popup"></div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.1/firebase-app.js";
  import {
    getFirestore, collection, query, where, getDocs, doc, getDoc
  } from "https://www.gstatic.com/firebasejs/10.12.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAe6sUwdJ292z-GKKLGjyOEmgjr4OiKR8w",
    authDomain: "truenrothbox.firebaseapp.com",
    projectId: "truenrothbox",
    storageBucket: "truenrothbox.firebasestorage.app",
    messagingSenderId: "103087965950",
    appId: "1:103087965950:web:cc552e40fc69a3d29047af"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  async function loadFeaturedProducts() {
    const container = document.getElementById('featured-products');
    const q = query(collection(db, "products"), where("isFeatured", "==", true));
    const snapshot = await getDocs(q);
    container.innerHTML = "";

    if (snapshot.empty) {
      container.innerHTML = "<p>No featured products available.</p>";
      return;
    }

    snapshot.forEach(doc => {
      const data = doc.data();
      const box = document.createElement('div');
      box.className = 'box';
      box.innerHTML = `
        <img src="${data.imageUrl}" alt="${data.name}">
        <h3>${data.name}</h3>
        <p>$${data.price}</p>
      `;
      box.addEventListener("mouseenter", () => showPreview(doc.id));
      box.addEventListener("mouseleave", () => hidePreview());
      box.onclick = () => window.location.href = `product.html?id=${doc.id}`;
      container.appendChild(box);
    });
  }

  const preview = document.getElementById('quickPreview');

  async function showPreview(id) {
    const docRef = doc(db, "products", id);
    const docSnap = await getDoc(docRef);
    if (docSnap.exists()) {
      const data = docSnap.data();
      preview.innerHTML = `
        <img src="${data.imageUrl}" />
        <h3>${data.name}</h3>
        <p>${data.description?.slice(0, 100) || "No description available."}</p>
        <a class="btn" href="product.html?id=${id}">View Details</a>
      `;
      preview.style.display = "block";
    }
  }

  function hidePreview() {
    preview.style.display = "none";
  }

  loadFeaturedProducts();
</script>
